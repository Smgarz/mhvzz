var floatingMenu={hasInner:"number"==typeof window.innerWidth,hasElement:"object"==typeof document.documentElement&&"number"==typeof document.documentElement.clientWidth},floatingArray=[];floatingMenu.add=function(t,e){var n,o;"string"==typeof t?n=t:o=t,null==e?floatingArray.push({id:n,menu:o,targetLeft:0,targetTop:0,snap:!0}):floatingArray.push({id:n,menu:o,targetLeft:e.targetLeft,targetRight:e.targetRight,targetTop:e.targetTop,targetBottom:e.targetBottom,centerX:e.centerX,centerY:e.centerY,prohibitXMovement:e.prohibitXMovement,prohibitYMovement:e.prohibitYMovement,snap:e.snap,ignoreParentDimensions:e.ignoreParentDimensions,scrollContainer:e.scrollContainer,scrollContainerId:e.scrollContainerId})},floatingMenu.findSingle=function(t){t.id&&(t.menu=document.getElementById(t.id)),t.scrollContainerId&&(t.scrollContainer=document.getElementById(t.scrollContainerId))},floatingMenu.move=function(t){t.prohibitXMovement||(t.menu.style.left=t.nextX+"px",t.menu.style.right=""),t.prohibitYMovement||(t.menu.style.top=t.nextY+"px",t.menu.style.bottom="")},floatingMenu.scrollLeft=function(t){if(t.scrollContainer)return t.scrollContainer.scrollLeft;for(var e=window;e!=e.parent;)e=e.parent;return this.hasInner?e.pageXOffset:this.hasElement?e.document.documentElement.scrollLeft:e.document.body.scrollLeft},floatingMenu.scrollTop=function(t){if(t.scrollContainer)return t.scrollContainer.scrollTop;for(var e=window;e!=e.parent;)e=e.parent;return this.hasInner?e.pageYOffset:this.hasElement?e.document.documentElement.scrollTop:e.document.body.scrollTop},floatingMenu.windowWidth=function(){return this.hasElement?document.documentElement.clientWidth:document.body.clientWidth},floatingMenu.windowHeight=function(){return floatingMenu.hasElement&&floatingMenu.hasInner?document.documentElement.clientHeight>window.innerHeight?window.innerHeight:document.documentElement.clientHeight:floatingMenu.hasElement?document.documentElement.clientHeight:document.body.clientHeight},floatingMenu.documentHeight=function(){var t=this.hasInner?window.innerHeight:0,e=document.body,n=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight,t)},floatingMenu.documentWidth=function(){var t=this.hasInner?window.innerWidth:0,e=document.body,n=document.documentElement;return Math.max(e.scrollWidth,e.offsetWidth,n.clientWidth,n.scrollWidth,n.offsetWidth,t)},floatingMenu.calculateCornerX=function(t){var e=t.menu.offsetWidth;if(t.centerX)return this.scrollLeft(t)+(this.windowWidth()-e)/2;var n=this.scrollLeft(t)-t.parentLeft;return null==t.targetLeft?n+=this.windowWidth()-t.targetRight-e:n+=t.targetLeft,document.body!=t.menu.parentNode&&n+e>=t.confinedWidthReserve&&(n=t.confinedWidthReserve-e),n<0&&(n=0),n},floatingMenu.calculateCornerY=function(t){var e=t.menu.offsetHeight;if(t.centerY)return this.scrollTop(t)+(this.windowHeight()-e)/2;var n=this.scrollTop(t)-t.parentTop;return void 0===t.targetTop?n+=this.windowHeight()-t.targetBottom-e:n+=t.targetTop,document.body!=t.menu.parentNode&&n+e>=t.confinedHeightReserve&&(n=t.confinedHeightReserve-e),n<0&&(n=0),n},floatingMenu.computeParent=function(t){if(t.ignoreParentDimensions)return t.confinedHeightReserve=this.documentHeight(),t.confinedWidthReserver=this.documentWidth(),t.parentLeft=0,void(t.parentTop=0);var e=t.menu.parentNode,n=this.offsets(e,t);t.parentLeft=n.left,t.parentTop=n.top,t.confinedWidthReserve=e.clientWidth;for(var o=e;o.clientHeight<t.menu.offsetHeight;)o=o.parentNode;var i=this.offsets(o,t);t.confinedHeightReserve=o.clientHeight-(n.top-i.top)},floatingMenu.offsets=function(t,e){var n={left:0,top:0};if(t!==e.scrollContainer){for(;t.offsetParent&&t.offsetParent!=e.scrollContainer;)n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;if(window==window.parent)return n;for(var o=window.parent.document.body.getElementsByTagName("IFRAME"),i=0;i<o.length;i++)if(o[i].contentWindow==window)for(t=o[i];t.offsetParent;)n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;return n}},floatingMenu.doFloatSingle=function(t){this.findSingle(t),this.computeParent(t);var e=this.calculateCornerX(t),n=.07*(e-t.nextX);(Math.abs(n)<.5&&t.snap||1==Math.abs(e-t.nextX))&&(n=e-t.nextX);var o=this.calculateCornerY(t),i=.07*(o-t.nextY);(Math.abs(i)<.5&&t.snap||1==Math.abs(o-t.nextY))&&(i=o-t.nextY),(Math.abs(n)>0||Math.abs(i)>0)&&(t.nextX+=n,t.nextY+=i,this.move(t))},floatingMenu.fixTargets=function(){},floatingMenu.fixTarget=function(t){},floatingMenu.doFloat=function(){this.fixTargets();for(var t=0;t<floatingArray.length;t++)this.fixTarget(floatingArray[t]),this.doFloatSingle(floatingArray[t]);setTimeout("floatingMenu.doFloat()",20)},floatingMenu.insertEvent=function(t,e,n){if(null==t.addEventListener){var o="on"+e;if(null==t.attachEvent){var i=t[o];t[o]=function(t){t=t||window.event;var e=n(t);return null!=i&&1==i(t)&&1==e}}else t.attachEvent(o,n)}else t.addEventListener(e,n,!1)},floatingMenu.init=function(){floatingMenu.fixTargets();for(var t=0;t<floatingArray.length;t++)floatingMenu.initSingleMenu(floatingArray[t]);setTimeout("floatingMenu.doFloat()",100)},floatingMenu.initSingleMenu=function(t){this.findSingle(t),this.computeParent(t),this.fixTarget(t),t.nextX=this.calculateCornerX(t),t.nextY=this.calculateCornerY(t),this.move(t)},floatingMenu.insertEvent(window,"load",floatingMenu.init),"undefined"!=typeof jQuery&&(jQuery.fn.addFloating=function(t){return this.each((function(){floatingMenu.add(this,t)}))});